
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python implementation to spawn ephemeral Model Context Protocol (MCP) servers using the kubernetes API.">
      
      
        <meta name="author" content="Bob Merkus">
      
      
        <link rel="canonical" href="https://BobMerkus.github.io/mcp-ephemeral-k8s/modules/">
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Modules - mcp-ephemeral-k8s</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="mcp-ephemeral-k8s" class="md-header__button md-logo" aria-label="mcp-ephemeral-k8s" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mcp-ephemeral-k8s
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/BobMerkus/mcp-ephemeral-k8s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    BobMerkus/mcp-ephemeral-k8s
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="mcp-ephemeral-k8s" class="md-nav__button md-logo" aria-label="mcp-ephemeral-k8s" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    mcp-ephemeral-k8s
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BobMerkus/mcp-ephemeral-k8s" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    BobMerkus/mcp-ephemeral-k8s
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Core Session Management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager" class="md-nav__link">
    <span class="md-ellipsis">
      session_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesSessionManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesSessionManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      __aenter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aexit__" class="md-nav__link">
    <span class="md-ellipsis">
      __aexit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.create_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.delete_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.expose_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      expose_mcp_server_port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.load_session_manager" class="md-nav__link">
    <span class="md-ellipsis">
      load_session_manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.mount_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mount_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.remove_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_port
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.cli.McpEphemeralK8s" class="md-nav__link">
    <span class="md-ellipsis">
      McpEphemeralK8s
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Application Layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.create_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.delete_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.get_mcp_server_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_mcp_server_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.get_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_version
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.health_check" class="md-nav__link">
    <span class="md-ellipsis">
      health_check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.lifespan" class="md-nav__link">
    <span class="md-ellipsis">
      lifespan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.list_mcp_servers" class="md-nav__link">
    <span class="md-ellipsis">
      list_mcp_servers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.list_presets" class="md-nav__link">
    <span class="md-ellipsis">
      list_presets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.mount_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mount_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.remove_mcp_server_mount" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_mount
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-models-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      API Models &amp; Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      ephemeral_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer" class="md-nav__link">
    <span class="md-ellipsis">
      EphemeralMcpServer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EphemeralMcpServer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.sse_url" class="md-nav__link">
    <span class="md-ellipsis">
      sse_url
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.url" class="md-nav__link">
    <span class="md-ellipsis">
      url
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      EphemeralMcpServerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EphemeralMcpServerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.args" class="md-nav__link">
    <span class="md-ellipsis">
      args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.image_name" class="md-nav__link">
    <span class="md-ellipsis">
      image_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.job_name" class="md-nav__link">
    <span class="md-ellipsis">
      job_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.from_docker_image" class="md-nav__link">
    <span class="md-ellipsis">
      from_docker_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.validate_runtime_exec" class="md-nav__link">
    <span class="md-ellipsis">
      validate_runtime_exec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesProbeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesProbeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesRuntime" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesRuntime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesRuntime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Exceptions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.InvalidKubeConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidKubeConfigError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPInvalidRuntimeError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPInvalidRuntimeError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobTimeoutError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPNamespaceNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPNamespaceNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPPortForwardError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPPortForwardError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPServerCreationError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPServerCreationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes Operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#job-management" class="md-nav__link">
    <span class="md-ellipsis">
      Job Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job" class="md-nav__link">
    <span class="md-ellipsis">
      job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.check_pod_status" class="md-nav__link">
    <span class="md-ellipsis">
      check_pod_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.create_mcp_server_job" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.create_proxy_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_proxy_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.delete_mcp_server_job" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.expose_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      expose_mcp_server_port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.get_mcp_server_job_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_mcp_server_job_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.remove_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_deletion" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_job_deletion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_ready" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_job_ready
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wait_for_job_ready">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rbac-management" class="md-nav__link">
    <span class="md-ellipsis">
      RBAC Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac" class="md-nav__link">
    <span class="md-ellipsis">
      rbac
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.RBACPreset" class="md-nav__link">
    <span class="md-ellipsis">
      RBACPreset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceAccountConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.UnknownRBACPresetError" class="md-nav__link">
    <span class="md-ellipsis">
      UnknownRBACPresetError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.create_service_account_for_job" class="md-nav__link">
    <span class="md-ellipsis">
      create_service_account_for_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.delete_service_account_for_job" class="md-nav__link">
    <span class="md-ellipsis">
      delete_service_account_for_job
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delete_service_account_for_job">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Utilities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.uid" class="md-nav__link">
    <span class="md-ellipsis">
      uid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.uid.generate_unique_id" class="md-nav__link">
    <span class="md-ellipsis">
      generate_unique_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrations-presets" class="md-nav__link">
    <span class="md-ellipsis">
      Integrations &amp; Presets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.integrations.presets" class="md-nav__link">
    <span class="md-ellipsis">
      presets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-session-management" class="md-nav__link">
    <span class="md-ellipsis">
      Core Session Management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager" class="md-nav__link">
    <span class="md-ellipsis">
      session_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesSessionManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesSessionManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      __aenter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aexit__" class="md-nav__link">
    <span class="md-ellipsis">
      __aexit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.create_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.delete_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.expose_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      expose_mcp_server_port
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.load_session_manager" class="md-nav__link">
    <span class="md-ellipsis">
      load_session_manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.mount_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mount_mcp_server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.remove_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_port
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Command Line Interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.cli.McpEphemeralK8s" class="md-nav__link">
    <span class="md-ellipsis">
      McpEphemeralK8s
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#application-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Application Layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.create_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.delete_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.get_mcp_server_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_mcp_server_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.get_version" class="md-nav__link">
    <span class="md-ellipsis">
      get_version
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.health_check" class="md-nav__link">
    <span class="md-ellipsis">
      health_check
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.lifespan" class="md-nav__link">
    <span class="md-ellipsis">
      lifespan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.list_mcp_servers" class="md-nav__link">
    <span class="md-ellipsis">
      list_mcp_servers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.list_presets" class="md-nav__link">
    <span class="md-ellipsis">
      list_presets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.mount_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      mount_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.app.mcp_server.remove_mcp_server_mount" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_mount
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-models-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      API Models &amp; Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server" class="md-nav__link">
    <span class="md-ellipsis">
      ephemeral_mcp_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer" class="md-nav__link">
    <span class="md-ellipsis">
      EphemeralMcpServer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EphemeralMcpServer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.sse_url" class="md-nav__link">
    <span class="md-ellipsis">
      sse_url
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.url" class="md-nav__link">
    <span class="md-ellipsis">
      url
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      EphemeralMcpServerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EphemeralMcpServerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.args" class="md-nav__link">
    <span class="md-ellipsis">
      args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.image_name" class="md-nav__link">
    <span class="md-ellipsis">
      image_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.job_name" class="md-nav__link">
    <span class="md-ellipsis">
      job_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.from_docker_image" class="md-nav__link">
    <span class="md-ellipsis">
      from_docker_image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.validate_runtime_exec" class="md-nav__link">
    <span class="md-ellipsis">
      validate_runtime_exec
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesProbeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesProbeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesRuntime" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesRuntime
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesRuntime">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Exceptions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.InvalidKubeConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidKubeConfigError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPInvalidRuntimeError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPInvalidRuntimeError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPJobTimeoutError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPNamespaceNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPNamespaceNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPPortForwardError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPPortForwardError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.api.exceptions.MCPServerCreationError" class="md-nav__link">
    <span class="md-ellipsis">
      MCPServerCreationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes Operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#job-management" class="md-nav__link">
    <span class="md-ellipsis">
      Job Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job" class="md-nav__link">
    <span class="md-ellipsis">
      job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.check_pod_status" class="md-nav__link">
    <span class="md-ellipsis">
      check_pod_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.create_mcp_server_job" class="md-nav__link">
    <span class="md-ellipsis">
      create_mcp_server_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.create_proxy_server" class="md-nav__link">
    <span class="md-ellipsis">
      create_proxy_server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.delete_mcp_server_job" class="md-nav__link">
    <span class="md-ellipsis">
      delete_mcp_server_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.expose_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      expose_mcp_server_port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.get_mcp_server_job_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_mcp_server_job_status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.remove_mcp_server_port" class="md-nav__link">
    <span class="md-ellipsis">
      remove_mcp_server_port
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_deletion" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_job_deletion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_ready" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_job_ready
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wait_for_job_ready">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rbac-management" class="md-nav__link">
    <span class="md-ellipsis">
      RBAC Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac" class="md-nav__link">
    <span class="md-ellipsis">
      rbac
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.RBACPreset" class="md-nav__link">
    <span class="md-ellipsis">
      RBACPreset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceAccountConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.UnknownRBACPresetError" class="md-nav__link">
    <span class="md-ellipsis">
      UnknownRBACPresetError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.create_service_account_for_job" class="md-nav__link">
    <span class="md-ellipsis">
      create_service_account_for_job
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.rbac.delete_service_account_for_job" class="md-nav__link">
    <span class="md-ellipsis">
      delete_service_account_for_job
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delete_service_account_for_job">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilities" class="md-nav__link">
    <span class="md-ellipsis">
      Utilities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.uid" class="md-nav__link">
    <span class="md-ellipsis">
      uid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.k8s.uid.generate_unique_id" class="md-nav__link">
    <span class="md-ellipsis">
      generate_unique_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrations-presets" class="md-nav__link">
    <span class="md-ellipsis">
      Integrations &amp; Presets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp_ephemeral_k8s.integrations.presets" class="md-nav__link">
    <span class="md-ellipsis">
      presets
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<h2 id="core-session-management">Core Session Management<a class="headerlink" href="#core-session-management" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.session_manager"></a>
    <div class="doc doc-contents first">

        <p>This module contains the session manager for the MCP ephemeral K8s library.
It is used to create and manage MCP servers in a Kubernetes cluster.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager" class="doc doc-heading">
            <code>KubernetesSessionManager</code>


<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Kubernetes session manager for MCP.</p>
<p>This manager creates and manages Kubernetes jobs for MCP sessions.
It implements the async context manager protocol for easy resource management.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KubernetesSessionManager</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kubernetes session manager for MCP.</span>

<span class="sd">    This manager creates and manages Kubernetes jobs for MCP sessions.</span>
<span class="sd">    It implements the async context manager protocol for easy resource management.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The namespace to create resources in&quot;</span><span class="p">)</span>
    <span class="n">jobs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EphemeralMcpServer</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A dictionary mapping between pod names and MCP servers jobs that are running.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">runtime</span><span class="p">:</span> <span class="n">KubernetesRuntime</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">KUBECONFIG</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The runtime to use for the MCP server&quot;</span>
    <span class="p">)</span>
    <span class="n">sleep_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The time to sleep between job status checks&quot;</span><span class="p">)</span>
    <span class="n">max_wait_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The maximum time to wait for a job to complete&quot;</span><span class="p">)</span>
    <span class="n">_api_client</span><span class="p">:</span> <span class="n">ApiClient</span> <span class="o">=</span> <span class="n">PrivateAttr</span><span class="p">()</span>
    <span class="n">_batch_v1</span><span class="p">:</span> <span class="n">BatchV1Api</span> <span class="o">=</span> <span class="n">PrivateAttr</span><span class="p">()</span>
    <span class="n">_core_v1</span><span class="p">:</span> <span class="n">CoreV1Api</span> <span class="o">=</span> <span class="n">PrivateAttr</span><span class="p">()</span>
    <span class="n">_rbac_v1</span><span class="p">:</span> <span class="n">RbacAuthorizationV1Api</span> <span class="o">=</span> <span class="n">PrivateAttr</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_session_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load Kubernetes configuration from default location or from service account if running in cluster.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_load_kube_config</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_api_client&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_batch_v1&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span> <span class="o">=</span> <span class="n">BatchV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_core_v1&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span> <span class="o">=</span> <span class="n">CoreV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_rbac_v1&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rbac_v1</span> <span class="o">=</span> <span class="n">RbacAuthorizationV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
        <span class="c1"># Check if the configured namespace exists using direct read (more efficient than listing all)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="o">.</span><span class="n">read_namespace</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPNamespaceNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_kube_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load Kubernetes configuration from default location or from service account if running in cluster.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">==</span> <span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">KUBECONFIG</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">load_kube_config</span><span class="p">(</span>
                    <span class="n">config_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;KUBECONFIG&quot;</span><span class="p">),</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;KUBECONTEXT&quot;</span><span class="p">),</span>
                    <span class="n">client_configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">persist_config</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="n">ConfigException</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load local kubernetes configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. Trying in-cluster configuration&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">INCLUSTER</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using local kubernetes configuration&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">==</span> <span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">INCLUSTER</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">load_incluster_config</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">FileNotFoundError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Failed to load in-cluster configuration&quot;</span>
                <span class="k">raise</span> <span class="n">InvalidKubeConfigError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using in-cluster kubernetes configuration&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">raise</span> <span class="n">InvalidKubeConfigError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enter the async context manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_session_manager</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exit the async context manager.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_create_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">EphemeralMcpServerConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a job that will run until explicitly terminated.</span>

<span class="sd">        This also creates a dedicated ServiceAccount with RBAC permissions for the spawned pod.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: The configuration for the MCP servers</span>

<span class="sd">        Returns:</span>
<span class="sd">            The MCP server instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create ServiceAccount and RBAC resources for the job</span>
        <span class="n">service_account_name</span> <span class="o">=</span> <span class="n">create_service_account_for_job</span><span class="p">(</span>
            <span class="n">core_v1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span>
            <span class="n">rbac_v1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rbac_v1</span><span class="p">,</span>
            <span class="n">job_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">sa_config</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">sa_config</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Create the job with the service account</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">create_mcp_server_job</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">service_account_name</span><span class="o">=</span><span class="n">service_account_name</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span><span class="o">.</span><span class="n">create_namespaced_job</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">job</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; created successfully&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job response: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPServerCreationError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">metadata</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">EphemeralMcpServer</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_get_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get current status of a job.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the pod</span>

<span class="sd">        Returns:</span>
<span class="sd">            The job status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_mcp_server_job_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_check_pod_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check the status of pods associated with a job.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the job/pod</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if a pod is running and ready (probes successful), False if waiting for pods</span>

<span class="sd">        Raises:</span>
<span class="sd">            MCPJobError: If a pod is in Failed or Unknown state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">check_pod_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_job_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for a job&#39;s pod to be in the running state and ready (probes successful).</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the job/pod</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">wait_for_job_ready</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_wait_time</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_job_deletion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for a job to be deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the job/pod</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">wait_for_job_deletion</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_wait_time</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_delete_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete a Kubernetes job and its associated pods.</span>

<span class="sd">        This also deletes the dedicated ServiceAccount and RBAC resources.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the job/pod</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the job was deleted successfully, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove service port if it exists</span>
        <span class="k">if</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove MCP server port for job </span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job </span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> not found in session manager, skipping port removal&quot;</span><span class="p">)</span>

        <span class="c1"># Delete the job and pods</span>
        <span class="n">job_deleted</span> <span class="o">=</span> <span class="n">delete_mcp_server_job</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

        <span class="c1"># Delete ServiceAccount and RBAC resources</span>
        <span class="k">if</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
            <span class="n">job_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span><span class="o">.</span><span class="n">config</span>
            <span class="n">cluster_wide</span> <span class="o">=</span> <span class="n">job_config</span><span class="o">.</span><span class="n">sa_config</span><span class="o">.</span><span class="n">cluster_wide</span> <span class="k">if</span> <span class="n">job_config</span><span class="o">.</span><span class="n">sa_config</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Default to cluster_wide=True if job not found in tracking</span>
            <span class="n">cluster_wide</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job </span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> config not found, using default cluster_wide=True for RBAC cleanup&quot;</span><span class="p">)</span>

        <span class="n">rbac_deleted</span> <span class="o">=</span> <span class="n">delete_service_account_for_job</span><span class="p">(</span>
            <span class="n">core_v1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span>
            <span class="n">rbac_v1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rbac_v1</span><span class="p">,</span>
            <span class="n">job_name</span><span class="o">=</span><span class="n">job_name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">cluster_wide</span><span class="o">=</span><span class="n">cluster_wide</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">job_deleted</span> <span class="ow">and</span> <span class="n">rbac_deleted</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_mcp_server</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">EphemeralMcpServerConfig</span><span class="p">,</span> <span class="n">wait_for_ready</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">expose_port</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a new MCP server using the provided configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: The configuration for the MCP servers</span>
<span class="sd">            wait_for_ready: Whether to wait for the job to be ready before returning a response to the client</span>
<span class="sd">            expose_port: Whether to expose the port through a Kubernetes service</span>

<span class="sd">        Returns:</span>
<span class="sd">            The MCP server instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mcp_server</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_job</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcp_server</span>
        <span class="k">if</span> <span class="n">wait_for_ready</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_job_ready</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> ready&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expose_port</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="n">mcp_server</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> port exposed with service &#39;</span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mcp_server</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">delete_mcp_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete the MCP server.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: Name of the job/pod</span>
<span class="sd">            wait_for_deletion: Whether to wait for the job to be deleted</span>

<span class="sd">        Returns:</span>
<span class="sd">            The MCP server instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">wait_for_deletion</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_job_deletion</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span><span class="o">.</span><span class="n">config</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">EphemeralMcpServer</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="n">job_name</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">raise</span> <span class="n">MCPJobNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">expose_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_server</span><span class="p">:</span> <span class="n">EphemeralMcpServer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Expose the MCP server port to the outside world through a Kubernetes service.&quot;&quot;&quot;</span>
        <span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_server</span><span class="p">:</span> <span class="n">EphemeralMcpServer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the MCP server.&quot;&quot;&quot;</span>
        <span class="n">remove_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mount_mcp_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">FastMCP</span><span class="p">,</span> <span class="n">EphemeralMcpServer</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mount an MCP server over SSE.</span>

<span class="sd">        Args:</span>
<span class="sd">            job_name: The name of the pod that is running the MCP server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">job_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPJobNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
        <span class="n">mcp_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span>
        <span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">sse_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">==</span> <span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">KUBECONFIG</span><span class="p">:</span>
            <span class="c1"># @TODO we need to port forward when running locally</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;http://localhost:</span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">/sse&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The MCP server is running locally, port forwarding to localhost is required if you want to access </span><span class="si">{</span><span class="n">url</span><span class="si">=!r}</span><span class="s2"> for </span><span class="si">{</span><span class="n">job_name</span><span class="si">=!r}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># we are running in a cluster</span>
            <span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">sse_url</span><span class="p">)</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">create_proxy_server</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mounted MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> over SSE&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">server</span><span class="p">,</span> <span class="n">mcp_server</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aenter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__aenter__</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aenter__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Enter the async context manager.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enter the async context manager.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_session_manager</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aexit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__aexit__</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.__aexit__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Exit the async context manager.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exit the async context manager.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.create_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_mcp_server</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">wait_for_ready</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">expose_port</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.create_mcp_server" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start a new MCP server using the provided configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServerConfig (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig">EphemeralMcpServerConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration for the MCP servers</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_ready</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for the job to be ready before returning a response to the client</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>expose_port</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to expose the port through a Kubernetes service</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP server instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_mcp_server</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">EphemeralMcpServerConfig</span><span class="p">,</span> <span class="n">wait_for_ready</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">expose_port</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a new MCP server using the provided configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: The configuration for the MCP servers</span>
<span class="sd">        wait_for_ready: Whether to wait for the job to be ready before returning a response to the client</span>
<span class="sd">        expose_port: Whether to expose the port through a Kubernetes service</span>

<span class="sd">    Returns:</span>
<span class="sd">        The MCP server instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcp_server</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_job</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">mcp_server</span>
    <span class="k">if</span> <span class="n">wait_for_ready</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_job_ready</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> ready&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">expose_port</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="n">mcp_server</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> port exposed with service &#39;</span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mcp_server</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.delete_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_mcp_server</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.delete_mcp_server" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Delete the MCP server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the job/pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_deletion</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to wait for the job to be deleted</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP server instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">delete_mcp_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete the MCP server.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: Name of the job/pod</span>
<span class="sd">        wait_for_deletion: Whether to wait for the job to be deleted</span>

<span class="sd">    Returns:</span>
<span class="sd">        The MCP server instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">job_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wait_for_deletion</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_job_deletion</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span><span class="o">.</span><span class="n">config</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">EphemeralMcpServer</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">raise</span> <span class="n">MCPJobNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.expose_mcp_server_port" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="n">mcp_server</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.expose_mcp_server_port" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Expose the MCP server port to the outside world through a Kubernetes service.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expose_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_server</span><span class="p">:</span> <span class="n">EphemeralMcpServer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Expose the MCP server port to the outside world through a Kubernetes service.&quot;&quot;&quot;</span>
    <span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.load_session_manager" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_session_manager</span><span class="p">()</span></code>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.load_session_manager" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load Kubernetes configuration from default location or from service account if running in cluster.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_session_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load Kubernetes configuration from default location or from service account if running in cluster.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_load_kube_config</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_api_client&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span> <span class="o">=</span> <span class="n">ApiClient</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_batch_v1&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_v1</span> <span class="o">=</span> <span class="n">BatchV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_core_v1&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span> <span class="o">=</span> <span class="n">CoreV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_rbac_v1&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rbac_v1</span> <span class="o">=</span> <span class="n">RbacAuthorizationV1Api</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_api_client</span><span class="p">)</span>
    <span class="c1"># Check if the configured namespace exists using direct read (more efficient than listing all)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="o">.</span><span class="n">read_namespace</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MCPNamespaceNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.mount_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mount_mcp_server</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.mount_mcp_server" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Mount an MCP server over SSE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod that is running the MCP server.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mount_mcp_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">FastMCP</span><span class="p">,</span> <span class="n">EphemeralMcpServer</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mount an MCP server over SSE.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: The name of the pod that is running the MCP server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">job_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">MCPJobNotFoundError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
    <span class="n">mcp_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_name</span><span class="p">]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">sse_url</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime</span> <span class="o">==</span> <span class="n">KubernetesRuntime</span><span class="o">.</span><span class="n">KUBECONFIG</span><span class="p">:</span>
        <span class="c1"># @TODO we need to port forward when running locally</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;http://localhost:</span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">/sse&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The MCP server is running locally, port forwarding to localhost is required if you want to access </span><span class="si">{</span><span class="n">url</span><span class="si">=!r}</span><span class="s2"> for </span><span class="si">{</span><span class="n">job_name</span><span class="si">=!r}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># we are running in a cluster</span>
        <span class="n">url</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">sse_url</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">create_proxy_server</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mounted MCP server </span><span class="si">{</span><span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2"> over SSE&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">server</span><span class="p">,</span> <span class="n">mcp_server</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.remove_mcp_server_port" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_mcp_server_port</span><span class="p">(</span><span class="n">mcp_server</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.session_manager.KubernetesSessionManager.remove_mcp_server_port" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Remove the MCP server.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/session_manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcp_server</span><span class="p">:</span> <span class="n">EphemeralMcpServer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove the MCP server.&quot;&quot;&quot;</span>
    <span class="n">remove_mcp_server_port</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_core_v1</span><span class="p">,</span> <span class="n">mcp_server</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">namespace</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="command-line-interface">Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.cli"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.cli.McpEphemeralK8s" class="doc doc-heading">
            <code>McpEphemeralK8s</code>


<a href="#mcp_ephemeral_k8s.cli.McpEphemeralK8s" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic_settings.BaseSettings">BaseSettings</span></code></p>


        <p>The MCP ephemeral K8s CLI.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/cli.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">McpEphemeralK8s</span><span class="p">(</span><span class="n">BaseSettings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The MCP ephemeral K8s CLI.&quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">SettingsConfigDict</span><span class="p">(</span><span class="n">cli_kebab_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">init</span><span class="p">:</span> <span class="n">CliSubCommand</span><span class="p">[</span><span class="n">Init</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Initialize the MCP ephemeral K8s client in the current directory&quot;</span><span class="p">)</span>
    <span class="n">serve</span><span class="p">:</span> <span class="n">CliSubCommand</span><span class="p">[</span><span class="n">Serve</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Serve the MCP ephemeral K8s client&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cli_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">CliApp</span><span class="o">.</span><span class="n">run_subcommand</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="application-layer">Application Layer<a class="headerlink" href="#application-layer" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.app.mcp_server"></a>
    <div class="doc doc-contents first">

        <p>MCP server application, meant to be used as an MCP server that can spawn other MCP servers.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.create_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_mcp_server</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">runtime_exec</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="p">,</span> <span class="n">runtime_args</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wait_for_ready</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.create_mcp_server" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a new ephemeral MCP server in Kubernetes.</p>
<p>Spawns a new MCP server instance as a Kubernetes Job with the specified configuration.
The server runs in an isolated environment and can be customized with different
runtime executors, packages, arguments, and environment variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>runtime_exec</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The executor to use for running the MCP server (e.g., 'uvx' for
Python packages, 'npx' for Node.js packages, 'docker' for container images).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runtime_mcp</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP package or image to run (e.g., 'mcp-server-sqlite' for a
Python-based SQLite MCP server, or '@modelcontextprotocol/server-filesystem'
for a Node.js filesystem server).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runtime_args</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional arguments to pass to the MCP server at runtime. These are
appended to the command line when starting the server.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of environment variables to set in the server's container.
Useful for configuration, authentication tokens, or feature flags.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_ready</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, this call will block until the Kubernetes Job is in a
ready state. If False, returns immediately after submitting the Job.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An EphemeralMcpServer object containing the created server's configuration,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pod name, status, and connection details.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>To create a filesystem MCP server: create_mcp_server(
    runtime_exec='npx',
    runtime_mcp='@modelcontextprotocol/server-filesystem',
    runtime_args='/tmp',
    wait_for_ready=True
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;create_mcp_server&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_mcp_server</span><span class="p">(</span>
    <span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span>
    <span class="n">runtime_exec</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">runtime_mcp</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">runtime_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">wait_for_ready</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new ephemeral MCP server in Kubernetes.</span>

<span class="sd">    Spawns a new MCP server instance as a Kubernetes Job with the specified configuration.</span>
<span class="sd">    The server runs in an isolated environment and can be customized with different</span>
<span class="sd">    runtime executors, packages, arguments, and environment variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        runtime_exec: The executor to use for running the MCP server (e.g., &#39;uvx&#39; for</span>
<span class="sd">            Python packages, &#39;npx&#39; for Node.js packages, &#39;docker&#39; for container images).</span>
<span class="sd">        runtime_mcp: The MCP package or image to run (e.g., &#39;mcp-server-sqlite&#39; for a</span>
<span class="sd">            Python-based SQLite MCP server, or &#39;@modelcontextprotocol/server-filesystem&#39;</span>
<span class="sd">            for a Node.js filesystem server).</span>
<span class="sd">        runtime_args: Optional arguments to pass to the MCP server at runtime. These are</span>
<span class="sd">            appended to the command line when starting the server.</span>
<span class="sd">        env: Optional dictionary of environment variables to set in the server&#39;s container.</span>
<span class="sd">            Useful for configuration, authentication tokens, or feature flags.</span>
<span class="sd">        wait_for_ready: If True, this call will block until the Kubernetes Job is in a</span>
<span class="sd">            ready state. If False, returns immediately after submitting the Job.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An EphemeralMcpServer object containing the created server&#39;s configuration,</span>
<span class="sd">        pod name, status, and connection details.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        To create a filesystem MCP server: create_mcp_server(</span>
<span class="sd">            runtime_exec=&#39;npx&#39;,</span>
<span class="sd">            runtime_mcp=&#39;@modelcontextprotocol/server-filesystem&#39;,</span>
<span class="sd">            runtime_args=&#39;/tmp&#39;,</span>
<span class="sd">            wait_for_ready=True</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">EphemeralMcpServerConfig</span><span class="p">(</span>
        <span class="n">runtime_exec</span><span class="o">=</span><span class="n">runtime_exec</span><span class="p">,</span>
        <span class="n">runtime_mcp</span><span class="o">=</span><span class="n">runtime_mcp</span><span class="p">,</span>
        <span class="n">runtime_args</span><span class="o">=</span><span class="n">runtime_args</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">session_manager</span><span class="p">:</span> <span class="n">KubernetesSessionManager</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">session_manager</span><span class="o">.</span><span class="n">create_mcp_server</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">wait_for_ready</span><span class="o">=</span><span class="n">wait_for_ready</span><span class="p">,</span> <span class="n">expose_port</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.delete_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_mcp_server</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.delete_mcp_server" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Delete an ephemeral MCP server and clean up its resources.</p>
<p>Terminates a running MCP server instance and removes its associated Kubernetes
resources including the Job, Pod, and any exposed Services. This is important
for cleaning up resources when an MCP server is no longer needed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod/server to delete. This is returned when creating
a server and can be retrieved using list_mcp_servers().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wait_for_deletion</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, this call will block until the Kubernetes resources
are fully deleted and removed from the cluster. If False, initiates deletion
and returns immediately.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An EphemeralMcpServer object containing the deleted server's final state and</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>metadata before removal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>After retrieving the list of servers, delete a specific one by its pod name:
delete_mcp_server(job_name='mcp-server-xyz123', wait_for_deletion=True)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;delete_mcp_server&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">delete_mcp_server</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete an ephemeral MCP server and clean up its resources.</span>

<span class="sd">    Terminates a running MCP server instance and removes its associated Kubernetes</span>
<span class="sd">    resources including the Job, Pod, and any exposed Services. This is important</span>
<span class="sd">    for cleaning up resources when an MCP server is no longer needed.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: The name of the pod/server to delete. This is returned when creating</span>
<span class="sd">            a server and can be retrieved using list_mcp_servers().</span>
<span class="sd">        wait_for_deletion: If True, this call will block until the Kubernetes resources</span>
<span class="sd">            are fully deleted and removed from the cluster. If False, initiates deletion</span>
<span class="sd">            and returns immediately.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An EphemeralMcpServer object containing the deleted server&#39;s final state and</span>
<span class="sd">        metadata before removal.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        After retrieving the list of servers, delete a specific one by its pod name:</span>
<span class="sd">        delete_mcp_server(job_name=&#39;mcp-server-xyz123&#39;, wait_for_deletion=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">session_manager</span><span class="p">:</span> <span class="n">KubernetesSessionManager</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">session_manager</span><span class="o">.</span><span class="n">delete_mcp_server</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">wait_for_deletion</span><span class="o">=</span><span class="n">wait_for_deletion</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.get_mcp_server_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_mcp_server_status</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.get_mcp_server_status" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the detailed Kubernetes status of an MCP server.</p>
<p>Retrieves the underlying Kubernetes Job status for a specific MCP server instance.
This provides low-level details about the Job's execution state, including
conditions, start/completion times, and any failure information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod/server to check. This identifier is returned
when creating a server and can be retrieved using list_mcp_servers().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Kubernetes V1Job object containing the Job's complete status information,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>or None if the Job is not found. The Job status includes fields such as:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>active: number of active pods</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>succeeded: number of succeeded pods</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>failed: number of failed pods</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>conditions: detailed state information</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>start_time and completion_time</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>Use this to debug issues with a server or to check if a Job has completed
successfully: get_mcp_server_status(job_name='mcp-server-xyz123')</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;get_mcp_server_status&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_mcp_server_status</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Job</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the detailed Kubernetes status of an MCP server.</span>

<span class="sd">    Retrieves the underlying Kubernetes Job status for a specific MCP server instance.</span>
<span class="sd">    This provides low-level details about the Job&#39;s execution state, including</span>
<span class="sd">    conditions, start/completion times, and any failure information.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: The name of the pod/server to check. This identifier is returned</span>
<span class="sd">            when creating a server and can be retrieved using list_mcp_servers().</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Kubernetes V1Job object containing the Job&#39;s complete status information,</span>
<span class="sd">        or None if the Job is not found. The Job status includes fields such as:</span>
<span class="sd">        - active: number of active pods</span>
<span class="sd">        - succeeded: number of succeeded pods</span>
<span class="sd">        - failed: number of failed pods</span>
<span class="sd">        - conditions: detailed state information</span>
<span class="sd">        - start_time and completion_time</span>

<span class="sd">    Example usage:</span>
<span class="sd">        Use this to debug issues with a server or to check if a Job has completed</span>
<span class="sd">        successfully: get_mcp_server_status(job_name=&#39;mcp-server-xyz123&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">session_manager</span><span class="p">:</span> <span class="n">KubernetesSessionManager</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">session_manager</span><span class="o">.</span><span class="n">_get_job_status</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.get_version" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_version</span><span class="p">()</span></code>

<a href="#mcp_ephemeral_k8s.app.mcp_server.get_version" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the version of the MCP ephemeral server.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s2">&quot;config://version&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_version</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the version of the MCP ephemeral server.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">__version__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.health_check" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">health_check</span><span class="p">(</span><span class="n">request</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.health_check" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Health check endpoint for the MCP server.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">custom_route</span><span class="p">(</span><span class="s2">&quot;/health&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">health_check</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PlainTextResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Health check endpoint for the MCP server.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PlainTextResponse</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.lifespan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lifespan</span><span class="p">(</span><span class="n">server</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.lifespan" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Lifecycle hooks for the MCP ephemeral server.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@asynccontextmanager</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">lifespan</span><span class="p">(</span><span class="n">server</span><span class="p">:</span> <span class="n">FastMCP</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">KubernetesSessionManager</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lifecycle hooks for the MCP ephemeral server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">KubernetesSessionManager</span><span class="p">(</span>
        <span class="n">namespace</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="p">{},</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_wait_time</span><span class="o">=</span><span class="mi">60</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">session_manager</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">session_manager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.list_mcp_servers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_mcp_servers</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.list_mcp_servers" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>List all currently running ephemeral MCP servers.</p>
<p>Retrieves information about all MCP server instances that are currently managed
by this controller. Each server entry includes its pod name, configuration details,
current status, creation timestamp, and connection information if available.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of EphemeralMcpServer objects representing all active MCP servers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="EphemeralMcpServer (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer">EphemeralMcpServer</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each object contains the server's configuration, runtime status, and metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>Call this tool to see what MCP servers are currently running before creating
new ones or to check the status of existing servers.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;list_mcp_servers&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_mcp_servers</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">EphemeralMcpServer</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all currently running ephemeral MCP servers.</span>

<span class="sd">    Retrieves information about all MCP server instances that are currently managed</span>
<span class="sd">    by this controller. Each server entry includes its pod name, configuration details,</span>
<span class="sd">    current status, creation timestamp, and connection information if available.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of EphemeralMcpServer objects representing all active MCP servers.</span>
<span class="sd">        Each object contains the server&#39;s configuration, runtime status, and metadata.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        Call this tool to see what MCP servers are currently running before creating</span>
<span class="sd">        new ones or to check the status of existing servers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">session_manager</span><span class="p">:</span> <span class="n">KubernetesSessionManager</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">session_manager</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.list_presets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_presets</span><span class="p">()</span></code>

<a href="#mcp_ephemeral_k8s.app.mcp_server.list_presets" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>List all available preset MCP server configurations.</p>
<p>Returns a list of pre-configured MCP server templates that can be used as examples
or starting points for creating new ephemeral MCP servers. Each preset includes
the runtime executor (e.g., 'uvx', 'npx'), the MCP package to install, optional
runtime arguments, and environment variables.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="EphemeralMcpServerConfig (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig">EphemeralMcpServerConfig</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of EphemeralMcpServerConfig objects containing preset configurations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="EphemeralMcpServerConfig (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig">EphemeralMcpServerConfig</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each config specifies how to run a specific MCP server package.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example usage</summary>
  <p>Use this to discover available MCP server configurations before creating one.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;list_presets&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_presets</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">EphemeralMcpServerConfig</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List all available preset MCP server configurations.</span>

<span class="sd">    Returns a list of pre-configured MCP server templates that can be used as examples</span>
<span class="sd">    or starting points for creating new ephemeral MCP servers. Each preset includes</span>
<span class="sd">    the runtime executor (e.g., &#39;uvx&#39;, &#39;npx&#39;), the MCP package to install, optional</span>
<span class="sd">    runtime arguments, and environment variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of EphemeralMcpServerConfig objects containing preset configurations.</span>
<span class="sd">        Each config specifies how to run a specific MCP server package.</span>

<span class="sd">    Example usage:</span>
<span class="sd">        Use this to discover available MCP server configurations before creating one.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">presets</span><span class="o">.</span><span class="n">EXAMPLE_MCP_SERVER_CONFIGS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s1">&#39;sse&#39;</span><span class="p">,</span> <span class="n">show_banner</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_origins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">transport_kwargs</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.app.mcp_server.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Run the FastMCP server.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
    <span class="n">transport</span><span class="p">:</span> <span class="n">Transport</span> <span class="o">=</span> <span class="s2">&quot;sse&quot;</span><span class="p">,</span>
    <span class="n">show_banner</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">allow_origins</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">transport_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the FastMCP server.&quot;&quot;&quot;</span>
    <span class="c1"># Configure CORS middleware for SSE transport to support browser-based clients</span>
    <span class="k">if</span> <span class="n">transport</span> <span class="o">==</span> <span class="s2">&quot;sse&quot;</span><span class="p">:</span>
        <span class="n">cors_middleware</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="n">CORSMiddleware</span><span class="p">,</span>
                <span class="p">(),</span>
                <span class="p">{</span>
                    <span class="s2">&quot;allow_origins&quot;</span><span class="p">:</span> <span class="n">allow_origins</span> <span class="ow">or</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;allow_credentials&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;allow_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;allow_headers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
                <span class="p">},</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="n">transport_kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;middleware&quot;</span><span class="p">,</span> <span class="n">cors_middleware</span><span class="p">)</span>

    <span class="n">mcp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="n">transport</span><span class="p">,</span> <span class="n">show_banner</span><span class="o">=</span><span class="n">show_banner</span><span class="p">,</span> <span class="o">**</span><span class="n">transport_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.mount_mcp_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mount_mcp_server</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.mount_mcp_server" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Mount a remote MCP server over SSE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod that is running the remote MCP server.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the proxy server.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;mount_mcp_server&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mount_mcp_server</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EphemeralMcpServer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mount a remote MCP server over SSE.</span>

<span class="sd">    Args:</span>
<span class="sd">        job_name: The name of the pod that is running the remote MCP server.</span>
<span class="sd">        name: The name of the proxy server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">session_manager</span><span class="p">:</span> <span class="n">KubernetesSessionManager</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">request_context</span><span class="o">.</span><span class="n">lifespan_context</span>
    <span class="n">server</span><span class="p">,</span> <span class="n">ephemeral_server</span> <span class="o">=</span> <span class="k">await</span> <span class="n">session_manager</span><span class="o">.</span><span class="n">mount_mcp_server</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
    <span class="n">mcp</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="n">server</span><span class="o">=</span><span class="n">server</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">as_proxy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ephemeral_server</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.app.mcp_server.remove_mcp_server_mount" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_mcp_server_mount</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.app.mcp_server.remove_mcp_server_mount" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Remove the mount of an MCP server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the server to remove. If None, all mounted servers with a prefix will be removed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/app/mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@mcp</span><span class="o">.</span><span class="n">tool</span><span class="p">(</span><span class="s2">&quot;remove_mcp_server_mount&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">remove_mcp_server_mount</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove the mount of an MCP server.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the server to remove. If None, all mounted servers with a prefix will be removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Collect servers to remove first to avoid index shifting issues</span>
    <span class="n">servers_to_remove</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">mounted_server</span>
        <span class="k">for</span> <span class="n">mounted_server</span> <span class="ow">in</span> <span class="n">mcp</span><span class="o">.</span><span class="n">_mounted_servers</span>
        <span class="k">if</span> <span class="n">mounted_server</span><span class="o">.</span><span class="n">prefix</span> <span class="o">==</span> <span class="n">name</span> <span class="ow">or</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mounted_server</span><span class="o">.</span><span class="n">prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">servers_to_remove</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;No mounted server found with name </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;No mounted servers found&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Remove servers from the list</span>
    <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers_to_remove</span><span class="p">:</span>
        <span class="n">mcp</span><span class="o">.</span><span class="n">_mounted_servers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="api-models-configuration">API Models &amp; Configuration<a class="headerlink" href="#api-models-configuration" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.api.ephemeral_mcp_server"></a>
    <div class="doc doc-contents first">

        <p>This module contains the models for the MCP ephemeral K8s library.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer" class="doc doc-heading">
            <code>EphemeralMcpServer</code>


<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>The MCP server that is running in a Kubernetes pod.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EphemeralMcpServer</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The MCP server that is running in a Kubernetes pod.&quot;&quot;&quot;</span>

    <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The name of the pod that is running the MCP server&quot;</span><span class="p">,</span> <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mcp-ephemeral-k8s-proxy-test&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">EphemeralMcpServerConfig</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The configuration that was used to create the MCP server&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span>
            <span class="n">EphemeralMcpServerConfig</span><span class="p">(</span>
                <span class="n">runtime_exec</span><span class="o">=</span><span class="s2">&quot;uvx&quot;</span><span class="p">,</span>
                <span class="n">runtime_mcp</span><span class="o">=</span><span class="s2">&quot;mcp-server-fetch&quot;</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span>
                <span class="n">cors_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore[prop-decorator]</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpUrl</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The Uniform Resource Locator (URL) for the MCP server.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">HttpUrl</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;http://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">job_name</span><span class="si">}</span><span class="s2">.default.svc.cluster.local:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">)</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore[prop-decorator]</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sse_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpUrl</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The Server-Sent Events (SSE) URL for the MCP server.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">HttpUrl</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">sse&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.sse_url" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sse_url</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.sse_url" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The Server-Sent Events (SSE) URL for the MCP server.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.url" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">url</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServer.url" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The Uniform Resource Locator (URL) for the MCP server.</p>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig" class="doc doc-heading">
            <code>EphemeralMcpServerConfig</code>


<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration for Kubernetes resources.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EphemeralMcpServerConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for Kubernetes resources.&quot;&quot;&quot;</span>

    <span class="n">runtime_exec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The runtime to use for the MCP container. When None, the image is assumed to be a MCP server instead of a proxy.&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;uvx&quot;</span><span class="p">,</span> <span class="s2">&quot;npx&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">runtime_mcp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The runtime to use for the MCP container. Can be any supported MCP server runtime loadable via the `runtime_exec`. See the [MCP Server Runtimes](https://github.com/modelcontextprotocol/servers/tree/main) for a list of supported runtimes.&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mcp-server-fetch&quot;</span><span class="p">,</span> <span class="s2">&quot;@modelcontextprotocol/server-github&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">runtime_args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The arguments to pass to the MCP server runtime.&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;--port 8080&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;ghcr.io/bobmerkus/mcp-ephemeral-k8s-proxy:latest&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The image to use for the MCP server proxy&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mcp-proxy&quot;</span><span class="p">],</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The entrypoint for the MCP container. Normally not changed unless a custom image is used.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The host to expose the MCP server on&quot;</span><span class="p">)</span>  <span class="c1"># noqa: S104</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The port to expose the MCP server on&quot;</span><span class="p">)</span>
    <span class="n">resource_requests</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="s2">&quot;100m&quot;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="s2">&quot;100Mi&quot;</span><span class="p">},</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Resource requests for the container&quot;</span>
    <span class="p">)</span>
    <span class="n">resource_limits</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cpu&quot;</span><span class="p">:</span> <span class="s2">&quot;200m&quot;</span><span class="p">,</span> <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="s2">&quot;200Mi&quot;</span><span class="p">},</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Resource limits for the container&quot;</span>
    <span class="p">)</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Environment variables to set for the container&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;</span><span class="p">:</span> <span class="s2">&quot;1234567890&quot;</span><span class="p">,</span> <span class="s2">&quot;GITHUB_DYNAMIC_TOOLSETS&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}],</span>
    <span class="p">)</span>
    <span class="n">cors_origins</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The origins to allow CORS from&quot;</span><span class="p">,</span>
        <span class="n">examples</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">probe_config</span><span class="p">:</span> <span class="n">KubernetesProbeConfig</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">KubernetesProbeConfig</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The configuration for the Kubernetes probe&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sa_config</span><span class="p">:</span> <span class="n">ServiceAccountConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ServiceAccount RBAC configuration. If None, uses minimal preset by default.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_runtime_exec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the runtime configuration.</span>
<span class="sd">        Both runtime_exec and runtime_mcp must be specified, or neither.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: runtime_exec is specified but runtime_mcp is not&quot;</span>
            <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: runtime_mcp is specified but runtime_exec is not&quot;</span>
            <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore[prop-decorator]</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The arguments to pass to the MCP server.</span>
<span class="sd">        [mcp-proxy](https://github.com/sparfenyuk/mcp-proxy?tab=readme-ov-file#21-configuration)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span><span class="p">,</span>
                <span class="s2">&quot;--pass-environment&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;--port=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;--host=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cors_origins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--allow-origin&quot;</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cors_origins</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_args</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-- </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_args</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">args</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore[prop-decorator]</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">image_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the image to use for the MCP server.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@computed_field</span>  <span class="c1"># type: ignore[prop-decorator]</span>
    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">job_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the job to use for the MCP server.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">generate_unique_id</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">image_name</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_docker_image</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an EphemeralMcpServerConfig from a Docker image.</span>
<span class="sd">        The image must be a MCP server image, otherwise an error is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ghcr.io/bobmerkus/mcp-ephemeral-k8s-proxy&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
            <span class="s2">&quot;ghcr.io/sparfenyuk/mcp-proxy&quot;</span>
        <span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: image is a proxy image, please use the `runtime_exec` and `runtime_mcp` fields to specify the MCP server to use.&quot;</span>
            <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">entrypoint</span><span class="o">=</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">runtime_exec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">args</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.args" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The arguments to pass to the MCP server.
<a href="https://github.com/sparfenyuk/mcp-proxy?tab=readme-ov-file#21-configuration">mcp-proxy</a></p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.image_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">image_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.image_name" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The name of the image to use for the MCP server.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.job_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">job_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.job_name" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The name of the job to use for the MCP server.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.from_docker_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_docker_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">entrypoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.from_docker_image" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create an EphemeralMcpServerConfig from a Docker image.
The image must be a MCP server image, otherwise an error is raised.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_docker_image</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entrypoint</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an EphemeralMcpServerConfig from a Docker image.</span>
<span class="sd">    The image must be a MCP server image, otherwise an error is raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ghcr.io/bobmerkus/mcp-ephemeral-k8s-proxy&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">image</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
        <span class="s2">&quot;ghcr.io/sparfenyuk/mcp-proxy&quot;</span>
    <span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: image is a proxy image, please use the `runtime_exec` and `runtime_mcp` fields to specify the MCP server to use.&quot;</span>
        <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">entrypoint</span><span class="o">=</span><span class="n">entrypoint</span><span class="p">,</span> <span class="n">runtime_exec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.validate_runtime_exec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_runtime_exec</span><span class="p">()</span></code>

<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig.validate_runtime_exec" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Validate the runtime configuration.
Both runtime_exec and runtime_mcp must be specified, or neither.</p>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_runtime_exec</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate the runtime configuration.</span>
<span class="sd">    Both runtime_exec and runtime_mcp must be specified, or neither.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: runtime_exec is specified but runtime_mcp is not&quot;</span>
        <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Invalid runtime: runtime_mcp is specified but runtime_exec is not&quot;</span>
        <span class="k">raise</span> <span class="n">MCPInvalidRuntimeError</span><span class="p">(</span><span class="n">runtime_exec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_exec</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runtime_mcp</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesProbeConfig" class="doc doc-heading">
            <code>KubernetesProbeConfig</code>


<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesProbeConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration for Kubernetes readiness probe.</p>
<p>The readiness probe is used to determine when a container is ready to accept traffic.
These defaults are tuned for MCP server startup, which may take time to install dependencies.</p>
<p>With defaults: waits 10s initially, then checks every 1s for up to 300 failures (5 minutes total).</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KubernetesProbeConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for Kubernetes readiness probe.</span>

<span class="sd">    The readiness probe is used to determine when a container is ready to accept traffic.</span>
<span class="sd">    These defaults are tuned for MCP server startup, which may take time to install dependencies.</span>

<span class="sd">    With defaults: waits 10s initially, then checks every 1s for up to 300 failures (5 minutes total).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">initial_delay_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Seconds to wait before performing the first probe (allows for container startup)&quot;</span>
    <span class="p">)</span>
    <span class="n">period_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;How often (in seconds) to perform the probe&quot;</span><span class="p">)</span>
    <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of seconds after which the probe times out&quot;</span><span class="p">)</span>
    <span class="n">success_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum consecutive successes for the probe to be considered successful after having failed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">failure_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of consecutive failures before giving up. With period_seconds=1, this allows 5 minutes for server startup&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesRuntime" class="doc doc-heading">
            <code>KubernetesRuntime</code>


<a href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.KubernetesRuntime" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.StrEnum">StrEnum</span></code></p>


        <p>The runtime that is being used for Kubeconfig</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/ephemeral_mcp_server.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KubernetesRuntime</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The runtime that is being used for Kubeconfig&quot;&quot;&quot;</span>

    <span class="n">KUBECONFIG</span> <span class="o">=</span> <span class="s2">&quot;KUBECONFIG&quot;</span>
    <span class="n">INCLUSTER</span> <span class="o">=</span> <span class="s2">&quot;INCLUSTER&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h3 id="exceptions">Exceptions<a class="headerlink" href="#exceptions" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.api.exceptions"></a>
    <div class="doc doc-contents first">

        <p>This module contains the exceptions for the MCP ephemeral K8s library.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.InvalidKubeConfigError" class="doc doc-heading">
            <code>InvalidKubeConfigError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.InvalidKubeConfigError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the kube config is invalid.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">InvalidKubeConfigError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the kube config is invalid.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Invalid kube config: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPInvalidRuntimeError" class="doc doc-heading">
            <code>MCPInvalidRuntimeError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPInvalidRuntimeError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ValueError">ValueError</span></code></p>


        <p>An error that occurs when the runtime is invalid.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPInvalidRuntimeError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An error that occurs when the runtime is invalid.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime_exec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">runtime_mcp</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid runtime: </span><span class="si">{</span><span class="n">runtime_exec</span><span class="si">=}</span><span class="s2"> and </span><span class="si">{</span><span class="n">runtime_mcp</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPJobError" class="doc doc-heading">
            <code>MCPJobError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the MCP job is in an error state.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPJobError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the MCP job is in an error state.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MCP job error: </span><span class="si">{</span><span class="n">namespace</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">job_name</span><span class="si">=}</span><span class="s2"> - </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPJobNotFoundError" class="doc doc-heading">
            <code>MCPJobNotFoundError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobNotFoundError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the MCP job is not found.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPJobNotFoundError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the MCP job is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to find MCP job: </span><span class="si">{</span><span class="n">namespace</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">job_name</span><span class="si">=}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError" class="doc doc-heading">
            <code>MCPJobTimeoutError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the MCP job times out.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPJobTimeoutError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the MCP job times out.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MCP job timed out: </span><span class="si">{</span><span class="n">namespace</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">job_name</span><span class="si">=}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPNamespaceNotFoundError" class="doc doc-heading">
            <code>MCPNamespaceNotFoundError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPNamespaceNotFoundError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ValueError">ValueError</span></code></p>


        <p>An error that occurs when the namespace is not found.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPNamespaceNotFoundError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An error that occurs when the namespace is not found.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Namespace not found: </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPPortForwardError" class="doc doc-heading">
            <code>MCPPortForwardError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPPortForwardError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the MCP port forward fails.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPPortForwardError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the MCP port forward fails.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to create port forward: </span><span class="si">{</span><span class="n">job_name</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">namespace</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">port</span><span class="si">=}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.api.exceptions.MCPServerCreationError" class="doc doc-heading">
            <code>MCPServerCreationError</code>


<a href="#mcp_ephemeral_k8s.api.exceptions.MCPServerCreationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Exception raised when the MCP server creation fails.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/api/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MCPServerCreationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the MCP server creation fails.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to create MCP server: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="kubernetes-operations">Kubernetes Operations<a class="headerlink" href="#kubernetes-operations" title="Permanent link">&para;</a></h2>
<h3 id="job-management">Job Management<a class="headerlink" href="#job-management" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.k8s.job"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.check_pod_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_pod_status</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.check_pod_status" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Check the status of pods associated with a job.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the job/pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if a pod is running and ready (probes successful), False if waiting for pods</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MCPJobError (mcp_ephemeral_k8s.api.exceptions.MCPJobError)" href="#mcp_ephemeral_k8s.api.exceptions.MCPJobError">MCPJobError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a pod is in Failed or Unknown state</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_pod_status</span><span class="p">(</span><span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check the status of pods associated with a job.</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        job_name: Name of the job/pod</span>
<span class="sd">        namespace: Kubernetes namespace</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if a pod is running and ready (probes successful), False if waiting for pods</span>

<span class="sd">    Raises:</span>
<span class="sd">        MCPJobError: If a pod is in Failed or Unknown state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pods</span> <span class="o">=</span> <span class="n">core_v1</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;job-name=</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pods</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No pods found for job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39;, waiting...&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pods</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">phase</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Handle error states</span>
        <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">phase</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Failed&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">]:</span>
            <span class="n">_handle_failed_pod</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">pod</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>

        <span class="c1"># Handle running pods</span>
        <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s2">&quot;Running&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_is_pod_ready</span><span class="p">(</span><span class="n">pod</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; pod is running and ready (probes successful)&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; pod is running but not ready yet (waiting for probes)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.create_mcp_server_job" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_mcp_server_job</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">service_account_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.create_mcp_server_job" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a job that will run until explicitly terminated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EphemeralMcpServerConfig (mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig)" href="#mcp_ephemeral_k8s.api.ephemeral_mcp_server.EphemeralMcpServerConfig">EphemeralMcpServerConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration for the MCP server</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>service_account_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional ServiceAccount name to use for the pod</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="kubernetes.client.V1Job">V1Job</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MCP server instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_mcp_server_job</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">EphemeralMcpServerConfig</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">service_account_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a job that will run until explicitly terminated.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: The configuration for the MCP server</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        service_account_name: Optional ServiceAccount name to use for the pod</span>

<span class="sd">    Returns:</span>
<span class="sd">        The MCP server instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert environment variables dictionary to list of V1EnvVar</span>
    <span class="n">env_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">V1EnvVar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">env</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>

    <span class="c1"># Configure the job</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">(</span>
        <span class="n">api_version</span><span class="o">=</span><span class="s2">&quot;batch/v1&quot;</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Job&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">),</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1JobSpec</span><span class="p">(</span>
            <span class="n">backoff_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">template</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1PodTemplateSpec</span><span class="p">(</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">job_name</span><span class="p">}),</span>
                <span class="n">spec</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1PodSpec</span><span class="p">(</span>
                    <span class="n">service_account_name</span><span class="o">=</span><span class="n">service_account_name</span><span class="p">,</span>
                    <span class="n">containers</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">client</span><span class="o">.</span><span class="n">V1Container</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">job_name</span><span class="p">,</span>
                            <span class="n">image</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
                            <span class="n">command</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">,</span>
                            <span class="n">image_pull_policy</span><span class="o">=</span><span class="s2">&quot;IfNotPresent&quot;</span><span class="p">,</span>
                            <span class="n">args</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">args</span><span class="p">,</span>
                            <span class="n">resources</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ResourceRequirements</span><span class="p">(</span>
                                <span class="n">requests</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">resource_requests</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">resource_limits</span>
                            <span class="p">),</span>
                            <span class="n">ports</span><span class="o">=</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">V1ContainerPort</span><span class="p">(</span><span class="n">container_port</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="p">)],</span>
                            <span class="n">env</span><span class="o">=</span><span class="n">env_list</span><span class="p">,</span>
                            <span class="n">readiness_probe</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1Probe</span><span class="p">(</span>
                                <span class="n">tcp_socket</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1TCPSocketAction</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
                                <span class="o">**</span><span class="n">config</span><span class="o">.</span><span class="n">probe_config</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(),</span>
                            <span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">],</span>
                    <span class="n">restart_policy</span><span class="o">=</span><span class="s2">&quot;Never&quot;</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">job</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.create_proxy_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_proxy_server</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.create_proxy_server" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a proxy server from a remote MCP server over SSE.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SSE endpoint URL of the remote MCP server</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for SSETransport configuration
- sse_read_timeout: SSE read timeout (default: 300s)
- headers: Optional HTTP headers dict
- auth: Optional authentication
- httpx_client_factory: Optional custom HTTPX client factory</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="fastmcp.FastMCP">FastMCP</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FastMCP proxy server instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>server = create_proxy_server(
...     url="http://pod.default.svc.cluster.local:8080/sse",
...     sse_read_timeout=600.0
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_proxy_server</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FastMCP</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a proxy server from a remote MCP server over SSE.</span>

<span class="sd">    Args:</span>
<span class="sd">        url: The SSE endpoint URL of the remote MCP server</span>
<span class="sd">        **kwargs: Additional keyword arguments for SSETransport configuration</span>
<span class="sd">            - sse_read_timeout: SSE read timeout (default: 300s)</span>
<span class="sd">            - headers: Optional HTTP headers dict</span>
<span class="sd">            - auth: Optional authentication</span>
<span class="sd">            - httpx_client_factory: Optional custom HTTPX client factory</span>

<span class="sd">    Returns:</span>
<span class="sd">        FastMCP proxy server instance</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; server = create_proxy_server(</span>
<span class="sd">        ...     url=&quot;http://pod.default.svc.cluster.local:8080/sse&quot;,</span>
<span class="sd">        ...     sse_read_timeout=600.0</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Only pass valid SSETransport parameters</span>
    <span class="n">valid_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sse_read_timeout&quot;</span><span class="p">,</span> <span class="s2">&quot;headers&quot;</span><span class="p">,</span> <span class="s2">&quot;auth&quot;</span><span class="p">,</span> <span class="s2">&quot;httpx_client_factory&quot;</span><span class="p">}</span>
    <span class="n">transport_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">valid_params</span><span class="p">}</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating proxy server for </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2"> with kwargs: </span><span class="si">{</span><span class="n">transport_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">remote_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">SSETransport</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">transport_kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">FastMCP</span><span class="o">.</span><span class="n">as_proxy</span><span class="p">(</span><span class="n">remote_client</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.delete_mcp_server_job" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_mcp_server_job</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.delete_mcp_server_job" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Delete a Kubernetes job and its associated pods.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.BatchV1Api">BatchV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes batch API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod to delete</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The namespace of the pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the job was deleted successfully, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_mcp_server_job</span><span class="p">(</span>
    <span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span> <span class="n">batch_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">BatchV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete a Kubernetes job and its associated pods.</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        batch_v1: The Kubernetes batch API client</span>
<span class="sd">        job_name: The name of the pod to delete</span>
<span class="sd">        namespace: The namespace of the pod</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the job was deleted successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pods</span> <span class="o">=</span> <span class="n">core_v1</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span><span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;app=</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pods</span><span class="o">.</span><span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">pod_name_to_delete</span> <span class="o">=</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="n">pod_name_to_delete</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting pod </span><span class="si">{</span><span class="n">pod_name_to_delete</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">core_v1</span><span class="o">.</span><span class="n">delete_namespaced_pod</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">pod_name_to_delete</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1DeleteOptions</span><span class="p">(</span><span class="n">grace_period_seconds</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">propagation_policy</span><span class="o">=</span><span class="s2">&quot;Background&quot;</span><span class="p">),</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error deleting pods&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">batch_v1</span><span class="o">.</span><span class="n">delete_namespaced_job</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1DeleteOptions</span><span class="p">(</span><span class="n">propagation_policy</span><span class="o">=</span><span class="s2">&quot;Foreground&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; deleted successfully&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error deleting job&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.expose_mcp_server_port" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expose_mcp_server_port</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.expose_mcp_server_port" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Expose the MCP server port to the outside world.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the pod (job name)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Port to expose</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expose_mcp_server_port</span><span class="p">(</span><span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expose the MCP server port to the outside world.</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        job_name: Name of the pod (job name)</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        port: Port to expose</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">core_v1</span><span class="o">.</span><span class="n">create_namespaced_service</span><span class="p">(</span>
        <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1Service</span><span class="p">(</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">job_name</span><span class="p">),</span>
            <span class="n">spec</span><span class="o">=</span><span class="n">client</span><span class="o">.</span><span class="n">V1ServiceSpec</span><span class="p">(</span>
                <span class="n">selector</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;job-name&quot;</span><span class="p">:</span> <span class="n">job_name</span><span class="p">},</span>
                <span class="n">ports</span><span class="o">=</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">V1ServicePort</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)],</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; created successfully&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.get_mcp_server_job_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_mcp_server_job_status</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.get_mcp_server_job_status" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Get the status of a Kubernetes job.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.BatchV1Api">BatchV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes batch API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the pod to get the status of</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The namespace of the pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None | <span title="kubernetes.client.V1Job">V1Job</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The status of the job</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_mcp_server_job_status</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">BatchV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the status of a Kubernetes job.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_v1: The Kubernetes batch API client</span>
<span class="sd">        job_name: The name of the pod to get the status of</span>
<span class="sd">        namespace: The namespace of the pod</span>

<span class="sd">    Returns:</span>
<span class="sd">        The status of the job</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">V1Job</span><span class="p">,</span> <span class="n">batch_v1</span><span class="o">.</span><span class="n">read_namespaced_job</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">))</span>

        <span class="c1"># Get status</span>
        <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">active</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">active</span> <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">active</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">succeeded</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">succeeded</span> <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">succeeded</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">failed</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">failed</span> <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">failed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; status:&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active pods: </span><span class="si">{</span><span class="n">active</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Succeeded pods: </span><span class="si">{</span><span class="n">succeeded</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed pods: </span><span class="si">{</span><span class="n">failed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Get job creation time</span>
        <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">job</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">creation_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">creation_time</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">creation_timestamp</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creation time: </span><span class="si">{</span><span class="n">creation_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting job status: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">job</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.remove_mcp_server_port" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_mcp_server_port</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.job.remove_mcp_server_port" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Remove the MCP server port from the outside world.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_mcp_server_port</span><span class="p">(</span><span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the MCP server port from the outside world.</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        job_name: Name of the pod</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">core_v1</span><span class="o">.</span><span class="n">delete_namespaced_service</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Service &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; deleted successfully&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.wait_for_job_deletion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wait_for_job_deletion</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_wait_time</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_deletion" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Wait for a job to be deleted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.BatchV1Api">BatchV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes batch API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sleep_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time to sleep between checks</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum time to wait before timing out</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MCPJobTimeoutError (mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError)" href="#mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError">MCPJobTimeoutError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the job is not deleted within max_wait_time</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_job_deletion</span><span class="p">(</span>
    <span class="n">batch_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">BatchV1Api</span><span class="p">,</span> <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">sleep_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_wait_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">60</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wait for a job to be deleted.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_v1: The Kubernetes batch API client</span>
<span class="sd">        job_name: Name of the pod</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        sleep_time: Time to sleep between checks</span>
<span class="sd">        max_wait_time: Maximum time to wait before timing out</span>

<span class="sd">    Raises:</span>
<span class="sd">        MCPJobTimeoutError: If the job is not deleted within max_wait_time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="n">max_wait_time</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPJobTimeoutError</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_mcp_server_job_status</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.job.wait_for_job_ready" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wait_for_job_ready</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">,</span> <span class="n">core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">sleep_time</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_wait_time</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#mcp_ephemeral_k8s.k8s.job.wait_for_job_ready" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Wait for a job's pod to be in the running state and ready (probes successful).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.BatchV1Api">BatchV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes batch API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the pod</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sleep_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time to sleep between checks</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_wait_time</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum time to wait before timing out</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MCPJobTimeoutError (mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError)" href="#mcp_ephemeral_k8s.api.exceptions.MCPJobTimeoutError">MCPJobTimeoutError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the job does not become ready within max_wait_time</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/job.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_job_ready</span><span class="p">(</span>
    <span class="n">batch_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">BatchV1Api</span><span class="p">,</span>
    <span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span>
    <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sleep_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_wait_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wait for a job&#39;s pod to be in the running state and ready (probes successful).</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_v1: The Kubernetes batch API client</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        job_name: Name of the pod</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        sleep_time: Time to sleep between checks</span>
<span class="sd">        max_wait_time: Maximum time to wait before timing out</span>

<span class="sd">    Raises:</span>
<span class="sd">        MCPJobTimeoutError: If the job does not become ready within max_wait_time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="n">max_wait_time</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MCPJobTimeoutError</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>

        <span class="n">job</span> <span class="o">=</span> <span class="n">get_mcp_server_job_status</span><span class="p">(</span><span class="n">batch_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">job</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; not found, waiting for pod to become ready...&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; status is None, waiting for pod to become ready...&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># Check if any pod is in running state and ready</span>
        <span class="k">if</span> <span class="n">check_pod_status</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">):</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">active</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; active&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">&#39; in unknown state, waiting...&quot;</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="rbac-management">RBAC Management<a class="headerlink" href="#rbac-management" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.k8s.rbac"></a>
    <div class="doc doc-contents first">

        <p>Helper functions for managing RBAC resources for spawned MCP server pods.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.k8s.rbac.RBACPreset" class="doc doc-heading">
            <code>RBACPreset</code>


<a href="#mcp_ephemeral_k8s.k8s.rbac.RBACPreset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.StrEnum">StrEnum</span></code></p>


        <p>Preset RBAC configurations for service accounts.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/rbac.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RBACPreset</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Preset RBAC configurations for service accounts.&quot;&quot;&quot;</span>

    <span class="n">MINIMAL</span> <span class="o">=</span> <span class="s2">&quot;minimal&quot;</span>
    <span class="n">EXTENSIVE</span> <span class="o">=</span> <span class="s2">&quot;extensive&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig" class="doc doc-heading">
            <code>ServiceAccountConfig</code>


<a href="#mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration for ServiceAccount RBAC permissions.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/rbac.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceAccountConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for ServiceAccount RBAC permissions.&quot;&quot;&quot;</span>

    <span class="n">preset</span><span class="p">:</span> <span class="n">RBACPreset</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">RBACPreset</span><span class="o">.</span><span class="n">MINIMAL</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The RBAC preset to use for the service account&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cluster_wide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether to create ClusterRole/ClusterRoleBinding (True) or Role/RoleBinding (False)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mcp_ephemeral_k8s.k8s.rbac.UnknownRBACPresetError" class="doc doc-heading">
            <code>UnknownRBACPresetError</code>


<a href="#mcp_ephemeral_k8s.k8s.rbac.UnknownRBACPresetError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="ValueError">ValueError</span></code></p>


        <p>Exception raised when an unknown RBAC preset is encountered.</p>








              <details class="quote">
                <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/rbac.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UnknownRBACPresetError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when an unknown RBAC preset is encountered.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preset</span><span class="p">:</span> <span class="n">RBACPreset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preset</span> <span class="o">=</span> <span class="n">preset</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown RBAC preset: </span><span class="si">{</span><span class="n">preset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.rbac.create_service_account_for_job" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_service_account_for_job</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">cluster_wide</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sa_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.rbac.create_service_account_for_job" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a ServiceAccount and RBAC resources for a spawned MCP server job.</p>
<p>This creates:
- A ServiceAccount
- A Role/ClusterRole with permissions based on the ServiceAccountConfig
- A RoleBinding/ClusterRoleBinding</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rbac_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.RbacAuthorizationV1Api">RbacAuthorizationV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes RBAC API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the job (used for naming resources)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cluster_wide</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to create ClusterRole/ClusterRoleBinding (default: True)
         Note: This parameter is deprecated when sa_config is provided</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sa_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ServiceAccountConfig (mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig)" href="#mcp_ephemeral_k8s.k8s.rbac.ServiceAccountConfig">ServiceAccountConfig</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ServiceAccount configuration with RBAC preset (default: minimal preset)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the created ServiceAccount</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/rbac.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_service_account_for_job</span><span class="p">(</span>
    <span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span>
    <span class="n">rbac_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">RbacAuthorizationV1Api</span><span class="p">,</span>
    <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cluster_wide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sa_config</span><span class="p">:</span> <span class="n">ServiceAccountConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a ServiceAccount and RBAC resources for a spawned MCP server job.</span>

<span class="sd">    This creates:</span>
<span class="sd">    - A ServiceAccount</span>
<span class="sd">    - A Role/ClusterRole with permissions based on the ServiceAccountConfig</span>
<span class="sd">    - A RoleBinding/ClusterRoleBinding</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        rbac_v1: The Kubernetes RBAC API client</span>
<span class="sd">        job_name: The name of the job (used for naming resources)</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        cluster_wide: Whether to create ClusterRole/ClusterRoleBinding (default: True)</span>
<span class="sd">                     Note: This parameter is deprecated when sa_config is provided</span>
<span class="sd">        sa_config: ServiceAccount configuration with RBAC preset (default: minimal preset)</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of the created ServiceAccount</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service_account_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">-sa&quot;</span>

    <span class="c1"># Create ServiceAccount</span>
    <span class="n">_create_service_account</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">service_account_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>

    <span class="c1"># Use ServiceAccountConfig if provided, otherwise use defaults</span>
    <span class="k">if</span> <span class="n">sa_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sa_config</span> <span class="o">=</span> <span class="n">ServiceAccountConfig</span><span class="p">()</span>

    <span class="n">rules</span> <span class="o">=</span> <span class="n">_get_rbac_rules_by_preset</span><span class="p">(</span><span class="n">sa_config</span><span class="o">.</span><span class="n">preset</span><span class="p">)</span>

    <span class="c1"># Create Role/ClusterRole and RoleBinding/ClusterRoleBinding</span>
    <span class="k">if</span> <span class="n">sa_config</span><span class="o">.</span><span class="n">cluster_wide</span><span class="p">:</span>
        <span class="n">_create_cluster_role_and_binding</span><span class="p">(</span><span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">service_account_name</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_create_role_and_binding</span><span class="p">(</span><span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">service_account_name</span><span class="p">,</span> <span class="n">rules</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">service_account_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.rbac.delete_service_account_for_job" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_service_account_for_job</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">cluster_wide</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.rbac.delete_service_account_for_job" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Delete the ServiceAccount and RBAC resources for a spawned MCP server job.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>core_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.CoreV1Api">CoreV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes core API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rbac_v1</code>
            </td>
            <td>
                  <code><span title="kubernetes.client.RbacAuthorizationV1Api">RbacAuthorizationV1Api</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Kubernetes RBAC API client</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the job</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>namespace</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Kubernetes namespace</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cluster_wide</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether ClusterRole/ClusterRoleBinding were created (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all resources were deleted successfully, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/rbac.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_service_account_for_job</span><span class="p">(</span>
    <span class="n">core_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">,</span>
    <span class="n">rbac_v1</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">RbacAuthorizationV1Api</span><span class="p">,</span>
    <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cluster_wide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delete the ServiceAccount and RBAC resources for a spawned MCP server job.</span>

<span class="sd">    Args:</span>
<span class="sd">        core_v1: The Kubernetes core API client</span>
<span class="sd">        rbac_v1: The Kubernetes RBAC API client</span>
<span class="sd">        job_name: The name of the job</span>
<span class="sd">        namespace: Kubernetes namespace</span>
<span class="sd">        cluster_wide: Whether ClusterRole/ClusterRoleBinding were created (default: True)</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if all resources were deleted successfully, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service_account_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">job_name</span><span class="si">}</span><span class="s2">-sa&quot;</span>

    <span class="c1"># Delete Role/ClusterRole and RoleBinding/ClusterRoleBinding</span>
    <span class="k">if</span> <span class="n">cluster_wide</span><span class="p">:</span>
        <span class="n">rbac_success</span> <span class="o">=</span> <span class="n">_delete_cluster_role_and_binding</span><span class="p">(</span><span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rbac_success</span> <span class="o">=</span> <span class="n">_delete_role_and_binding</span><span class="p">(</span><span class="n">rbac_v1</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>

    <span class="c1"># Delete ServiceAccount</span>
    <span class="n">sa_success</span> <span class="o">=</span> <span class="n">_delete_service_account</span><span class="p">(</span><span class="n">core_v1</span><span class="p">,</span> <span class="n">service_account_name</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rbac_success</span> <span class="ow">and</span> <span class="n">sa_success</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="utilities">Utilities<a class="headerlink" href="#utilities" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.k8s.uid"></a>
    <div class="doc doc-contents first">

        <p>This module contains a utility function to generate unique identifiers for MCP ephemeral K8s resources based on RFC 1123 Label Names.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="mcp_ephemeral_k8s.k8s.uid.generate_unique_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_unique_id</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">63</span><span class="p">)</span></code>

<a href="#mcp_ephemeral_k8s.k8s.uid.generate_unique_id" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generate a unique identifier that follows the Kubernetes naming rules (RFC 1123 Label Names).</p>
<p>RFC 1123 Label Names must:
- Contain only lowercase alphanumeric characters or '-'
- Start with an alphanumeric character
- End with an alphanumeric character
- Be at most 63 characters</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional prefix for the ID. Will be converted to lowercase and non-compliant
    characters will be replaced with dashes.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum length of the generated ID, defaults to 63 (K8s limit).</p>
              </div>
            </td>
            <td>
                  <code>63</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique RFC 1123 compliant identifier string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/mcp_ephemeral_k8s/k8s/uid.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_unique_id</span><span class="p">(</span><span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">63</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a unique identifier that follows the Kubernetes naming rules (RFC 1123 Label Names).</span>

<span class="sd">    RFC 1123 Label Names must:</span>
<span class="sd">    - Contain only lowercase alphanumeric characters or &#39;-&#39;</span>
<span class="sd">    - Start with an alphanumeric character</span>
<span class="sd">    - End with an alphanumeric character</span>
<span class="sd">    - Be at most 63 characters</span>

<span class="sd">    Args:</span>
<span class="sd">        prefix: Optional prefix for the ID. Will be converted to lowercase and non-compliant</span>
<span class="sd">                characters will be replaced with dashes.</span>
<span class="sd">        max_length: Maximum length of the generated ID, defaults to 63 (K8s limit).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A unique RFC 1123 compliant identifier string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Process prefix if provided</span>
    <span class="n">processed_prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
        <span class="c1"># Convert to lowercase and replace invalid characters</span>
        <span class="n">processed_prefix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">islower</span><span class="p">()</span> <span class="k">else</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prefix</span>
        <span class="p">)</span>

        <span class="c1"># Ensure prefix starts with alphanumeric</span>
        <span class="k">if</span> <span class="n">processed_prefix</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">processed_prefix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
            <span class="n">processed_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;p</span><span class="si">{</span><span class="n">processed_prefix</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Add separator</span>
        <span class="k">if</span> <span class="n">processed_prefix</span><span class="p">:</span>
            <span class="n">processed_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">processed_prefix</span><span class="si">}</span><span class="s2">-&quot;</span>

    <span class="c1"># Generate a unique part (timestamp + random)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>
    <span class="n">random_chars</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>  <span class="c1"># noqa: S311</span>
    <span class="n">unique_part</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">random_chars</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Combine and ensure max length</span>
    <span class="n">full_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">processed_prefix</span><span class="si">}{</span><span class="n">unique_part</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_length</span><span class="p">:</span>
        <span class="c1"># If too long, truncate the ID but keep the random part</span>
        <span class="n">chars_to_keep</span> <span class="o">=</span> <span class="n">max_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">full_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_id</span><span class="p">[:</span><span class="n">chars_to_keep</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">random_chars</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Ensure ID ends with alphanumeric</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">full_id</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
        <span class="n">full_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}{</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: S311</span>

    <span class="k">return</span> <span class="n">full_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="integrations-presets">Integrations &amp; Presets<a class="headerlink" href="#integrations-presets" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="mcp_ephemeral_k8s.integrations.presets"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">












  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://BobMerkus.com">BobMerkus</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/BobMerkus/mcp-ephemeral-k8s" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mcp-ephemeral-k8s" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>